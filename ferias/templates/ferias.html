{% extends "base.html" %}
{% load static %}

{% block title %}Buscador{% endblock title %}

{% block styles %}
{% endblock %}
{% block scripts %}
{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div id="filters" class="col-md-4">
            <form id="buscador" class="form-inline" method="get" action="/ferias">
                <div class="form-group">
                    <label for="search">Buscar feria</label>
                    <input type="text" class="form-control" id="search" aria-describedby="searchHelp"
                        placeholder="Busque una feria" name="search">
                    <small id="searchHelp" class="form-text text-muted">Se buscará por Nombre o Comite.</small>
                    <button type="submit" class="btn btn-primary mb-2" value="submit">Buscar</button>
                    <button type="submit" class="btn btn-secondary mb-2" onclick="limpiarFiltros();">Limpiar filtros</button>
                </div>
                <small>Filtrar</small><br>
                <div class="form-check ">
                    <input class="form-check-input" type="checkbox" id="parqueo" value="1" name="parqueo" disabled>
                    <label class="form-check-label" for="parqueo">Parqueo</label>
                    <i class="bi bi-info-circle" data-bs-toggle="tooltip" data-bs-placement="top" 
                        title="Buscar ferias con parqueo"></i>
                </div>
                <div class="form-check ">
                    <input class="form-check-input" type="checkbox" id="parqueo_bici" value="1" name="parqueo_bici" disabled>
                    <label class="form-check-label" for="parqueo_bici">Parqueo Bicicletas</label>
                    <i class="bi bi-info-circle" data-bs-toggle="tooltip" data-bs-placement="top" 
                        title="Buscar ferias con parqueo para bicicletas"></i>
                </div>
                <div class="form-check ">
                    <input class="form-check-input" type="checkbox" id="sanitarios" value="1" name="sanitarios" disabled>
                    <label class="form-check-label" for="sanitarios">Servicios Sanitarios</label>
                    <i class="bi bi-info-circle"  data-bs-toggle="tooltip" data-bs-placement="top" 
                        title="Buscar ferias con servicios sanitarios"></i>
                </div>
                <div class="form-check ">
                    <input class="form-check-input" type="checkbox" id="bajo_techo" value="1" name="bajo_techo" disabled>
                    <label class="form-check-label" for="bajo_techo">Bajo Techo</label>
                    <i class="bi bi-info-circle" data-bs-toggle="tooltip" data-bs-placement="top" 
                        title="Buscar ferias que esten bajo techo"></i>
                </div>
                <div class="form-check ">
                    <input class="form-check-input" type="checkbox" id="campo_ferial" value="1" name="campo_ferial" disabled>
                    <label class="form-check-label" for="campo_ferial">Campo Ferial</label>
                    <i class="bi bi-info-circle" data-bs-toggle="tooltip" data-bs-placement="top" 
                        title="Buscar ferias que esten en un campo ferial"></i>
                </div>
                <div class="form-check ">
                    <input class="form-check-input" type="checkbox" id="agua_potable" value="1" name="agua_potable" disabled>
                    <label class="form-check-label" for="agua_potable">Agua Potable</label>
                    <i class="bi bi-info-circle" data-bs-toggle="tooltip" data-bs-placement="top" 
                        title="Buscar ferias que cuenten con agua potable"></i>
                </div>
                <div class="form-check ">
                    <input class="form-check-input" type="checkbox" id="accesibilidad" value="1" name="accesibilidad" disabled>
                    <label class="form-check-label" for="accesibilidad">Accesibilidad</label>
                    <i class="bi bi-info-circle" data-bs-toggle="tooltip" data-bs-placement="top" 
                        title="Buscar ferias que cumplan la ley 7600"></i>
                </div>
                <div id="demo"></div>
                <input type="text" id="lat" name="lat" hidden/>
                <input type="text" id="lon" name="lon" hidden/>
                <div style="display: none;" id="radiusGroup">
                    <label for="radius" class="form-label">
                        Seleccione el radio de la búsqueda en KM: <small id="radioText">1</small>
                    </label>
                    <input type="range" class="form-range" id="radius" name="radius" min="1000" max="50000" step="1000"
                        onchange="updateRadiusInput(this.value);" oninput="updateRadiusInput(this.value);" value="0">
                </div>
                <select class="form-select" aria-label="Provincia" name="provincia" id="provincia">
                    <option selected value="-1">Seleccione una provincia</option>                    
                </select>
                <select class="form-select" aria-label="Cantón" name="canton" id="canton">
                    <option selected value="-1">Seleccione un cantón</option>
                </select>
                <select class="form-select" aria-label="Distrito" name="distrito" id="distrito">
                    <option selected value="-1">Seleccione un distrito</option>
                </select>
            </form>
            <button class="btn btn-primary sm" onclick="getLocation();">Usar mi ubicación</button>
        </div>
        <div id="ferias-list" class="col-md-8">
                Lista de ferias
                <div> 
                    {% if ferias.object_list.count > 0 %}
                    <ul>
                        {% for feria in ferias %}
                        <li>{{ feria.nombre }}</li>
                        {% endfor %}
                    </ul>
                    <!-- Paginacion -->
                    {% if ferias.has_other_pages %}
                    <nav aria-label="Paginación de la lista de ferias">
                        <ul class="pagination justify-content-center">
                            <!-- Boton de previo -->
                            {% if ferias.has_previous %}
                            <li class="page-item">
                                <a class="page-link" href="#" onclick="getPage({{ ferias.previous_page_number }});">Anterior</a>
                            </li>
                            {% else %}
                            <li class="page-item disabled">
                                <a class="page-link" href="#" tabindex="-1" arias-disabled="True">Anterior</a>
                            </li>
                            {% endif %}

                            <!-- Paginas disponibles -->
                            {% for i in ferias.paginator.page_range %}
                            {% if ferias.number == i %}
                            <li class="page-item active" aria-current="page">
                                <span class="page-link">
                                    {{ i }}
                                </span>
                            </li>
                            {% else %}
                            <li class="page-item"><a class="page-link" href="#" onclick="getPage({{ i }});">{{ i }}</a></li>
                            {% endif %}
                            {% endfor %}

                            <!-- Boton de siguiente -->
                            {% if ferias.has_next %}
                            <li class="page-item">
                                <a class="page-link" href="#" onclick="getPage({{ ferias.next_page_number }});">Siguiente</a>
                            </li>
                            {% else %}
                            <li class="page-item disabled">
                                <a class="page-link" href="#" tabindex="-1" arias-disabled="True">Siguiente</a>
                            </li>
                            {% endif %}
                        </ul>
                    </nav>
                    {% endif %}
                    {% else %}
                    <h4>No se encontraron ferias</h4>
                    {% endif %}
                </div>
        </div>
    </div>
</div>
{% endblock %}
{% block scriptsEnd %}
<script src="{% static 'js/ferias.js' %}" type="text/javascript"></script>
{% endblock %}